<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>vidner</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is meta description">
  <meta name="author" content="Themefisher">
  <meta name="generator" content="Hugo 0.58.3" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://vidner.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://vidner.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://vidner.github.io/plugins/themify-icons/themify-icons.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://vidner.github.io/css/style.min.css" integrity="" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://vidner.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://vidner.github.io/images/favicon.png " type="image/x-icon">

</head><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
   <script>hljs.initHighlightingOnLoad();</script>
   <link rel="stylesheet" href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/xt256.min.css>
   <body>
<!-- preloader start -->
<div class="preloader">
</div>
<!-- preloader end -->
<header class="navigation fixed-top">
  <nav class="navbar navbar-expand-lg navbar-dark">
    <a class="navbar-brand" href="https://vidner.github.io"><h3 class="text-white font-tertiary">vidner</h3></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
      aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navigation">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item active">
          <a class="nav-link" href="https://vidner.github.io"> Home </a>
        </li>
        
        
        <li class="nav-item">
          <a class="nav-link" href="https://vidner.github.io/about">About</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link" href="https://vidner.github.io/blog">Blog</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link" href="https://vidner.github.io/contact">Contact</a>
        </li>
        
        
      </ul>
    </div>
  </nav>
</header>

  
<section class="page-title bg-primary position-relative overflow-hidden">
  <div class="container">
    <div class="row">
      <div class="col-12 text-center">
        <h1 class="text-white font-tertiary">[ inctf - 2019 - rev ] Cliche_crackme</h1>
      </div>
    </div>
  </div>
  
  <img src="/images/illustrations/page-title.svg" alt="illustrations" class="bg-shape-1 w-100">
  <img src="/images/illustrations/leaf-pink-round.svg" alt="illustrations" class="bg-shape-2">
  <img src="/images/illustrations/dots-cyan.svg" alt="illustrations" class="bg-shape-3">
  <img src="/images/illustrations/leaf-orange.svg" alt="illustrations" class="bg-shape-4">
  <img src="/images/illustrations/leaf-yellow.svg" alt="illustrations" class="bg-shape-5">
  <img src="/images/illustrations/dots-group-cyan.svg" alt="illustrations" class="bg-shape-6">
  <img src="/images/illustrations/leaf-cyan-lg.svg" alt="illustrations" class="bg-shape-7">
</section>



  <section class="section">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h3 class="font-tertiary mb-5">[ inctf - 2019 - rev ] Cliche_crackme</h3>
          <p class="font-secondary">Published on Sep 26, 2019 by <span class="text-primary">vidner</span></p>
          <div class="content">
            <img src="https://vidner.github.io/images/writeup/INCTF-logo.png" alt="post-thumb" class="img-fluid rounded float-left mr-5 mb-4">
            

<h3 id="cliche-crackme">cliche_crackme</h3>

<p>Soo cliche.. One for the noobs out there like us!!</p>

<h3 id="attachment">attachment</h3>

<p>cliche_crackme: <br>Mach-O 64-bit x86_64 executable.</p>

<h3 id="decompiled">decompiled</h3>

<h4 id="start">start</h4>

<pre><code class="language-c">__int64 start()
{
  void *v1; // [rsp+30h] [rbp-40h]
  char v2; // [rsp+40h] [rbp-30h]

  v1 = calloc(0x29BuLL, 4uLL);
  scanf(&quot;%s&quot;, &amp;v2);
  sub_100000DB0(sub_100000D00, sub_100000C80, sub_100000BA0, sub_100000C10, &amp;v2, v1);
  return 0LL;
}
</code></pre>

<h4 id="sub-100000db0">sub_100000DB0</h4>

<pre><code class="language-c">__int64 __fastcall sub_100000DB0(void (__fastcall *a1)(__int64, __int64), unsigned int (__fastcall *a2)(__int64, void *), unsigned int (__fastcall *a3)(__int64), unsigned int (__fastcall *a4)(__int64), __int64 a5, __int64 a6)
{
  __int64 v7; // [rsp+10h] [rbp-30h]
  __int64 v8; // [rsp+18h] [rbp-28h]
  unsigned int (__fastcall *v9)(__int64); // [rsp+20h] [rbp-20h]
  unsigned int (__fastcall *v10)(__int64); // [rsp+28h] [rbp-18h]

  v10 = a3;
  v9 = a4;
  v8 = a5;
  v7 = a6;
  a1(a6, a5);
  if ( v10(v8) &amp;&amp; v9(v7) &amp;&amp; a2(v7, &amp;unk_100001040) )
    printf(&quot;Congratz - You have earned it!&quot;);
  else
    printf(&quot;%s&quot;, &quot;You've got to do better&quot;);
  return 0LL;
}
</code></pre>

<h4 id="sub-100000d00">sub_100000D00</h4>

<pre><code class="language-c">__int64 __fastcall sub_100000D00(__int64 a1, const char *a2)
{
  __int64 result; // rax
  int j; // [rsp+0h] [rbp-20h]
  int i; // [rsp+4h] [rbp-1Ch]
  int v5; // [rsp+8h] [rbp-18h]
  int v6; // [rsp+Ch] [rbp-14h]

  v6 = strlen(a2);
  v5 = 0;
  for ( i = 0; i &lt; v6; ++i )
  {
    for ( j = i + 1; j &lt; v6; ++j )
      *(_DWORD *)(a1 + 4LL * v5++) = a2[j] + a2[i];
  }
  result = a1;
  *(_DWORD *)(a1 + 2668) = 0;
  return result;
}
</code></pre>

<h4 id="sub-100000c80">sub_100000C80</h4>

<pre><code class="language-c">_BOOL8 __fastcall sub_100000C80(__int64 a1, __int64 a2)
{
  int v3; // [rsp+0h] [rbp-1Ch]

  v3 = 0;
  while ( v3 &lt; 666 )
  {
    if ( *(_DWORD *)(a1 + 4LL * v3) == *(_DWORD *)(a2 + 4LL * v3) )
      ++v3;
  }
  return v3 &gt;= 666;
}
</code></pre>

<h3 id="analysis">analysis</h3>

<p>in order to get the flag , this <code>if ( v10(v8) &amp;&amp; v9(v7) &amp;&amp; a2(v7, &amp;unk_100001040)</code> condition must be true . but actually yes , emm no , emm idk , after reading all the functions i found out that , this <code>a2(v7, &amp;unk_100001040)</code> condition is enough to get the flag ,because the other condition will return true if we get this one true. a2 or <code>sub_100000C80</code> is a function with 2 paramater , each of them is a array , if those 2 array are equal this function should return true. so we need to make <code>v7</code> is equal to <code>&amp;unk_100001040</code>.</p>

<p><code>v7</code> initiated with <code>a1(a6, a5);</code> or <code>sub_100000D00</code> . a1 is a function with 2 parameter , the fisrt paramater is an allocated array , and the second parameter is our input. nested loop in this function fill <code>alloc[ v5 ]</code> with <code>input[i]+input[j]</code> , btw <code>v5</code> is a <code>counter</code>.
 example : alloc[0] = input[0]+input[1] .</p>

<p>this is what &amp;unk_100001040 look like</p>

<pre><code class="language-c">__data:0000000100001040 unk_100001040   db 0D7h                 ; DATA XREF: sub_100000DB0+5Câ†‘o
__data:0000000100001041                 db    0
__data:0000000100001042                 db    0
__data:0000000100001043                 db    0
__data:0000000100001044                 db 0CCh
__data:0000000100001045                 db    0
__data:0000000100001046                 db    0
__data:0000000100001047                 db    0
__data:0000000100001048                 db 0DDh
__data:0000000100001049                 db    0
__data:000000010000104A                 db    0
__data:000000010000104B                 db    0
__data:000000010000104C                 db 0CFh
...
...
__data:0000000100001AA4                 db 0BCh
__data:0000000100001AA5                 db    0
__data:0000000100001AA6                 db    0
__data:0000000100001AA7                 db    0
__data:0000000100001AA7 __data          ends
</code></pre>

<p>conclusion , we need to fill <code>alloc[i]</code> that would have the same exact value with <code>unk_100001040[i]</code>. we can solve this with <code>z3</code> sat solver.</p>

<h3 id="script">script</h3>

<pre><code class="language-python">from z3 import *

LEN = 37 
s = Solver()
a1 = [BitVec(i, 32) for i in range(LEN)]

# ========================================

a = [0x0D7, 0x0CC, 0x0DD, 0x0CF, 0x0E4, 0x0BD, 0x0D1, 0x9D, 0x0DD, 0x0DC, 0x0C8, 0x0D1, 0x0CE, 0x9A, 0x9A, 0x0C8, 0x0D5, 0x99, 0x0DD, 0x0C8, 0x99, 0x0CF, 0x0C8, 0x0E0, 0x99, 0x0DB, 0x0D4, 0x0C8, 0x0E0, 0x9D, 0x0DC, 0x0C8, 0x0D2, 0x0DD, 0x0A8, 0x0E6, 0x0D1, 0x0E2, 0x0D4, 0x0E9, 0x0C2, 0x0D6, 0x0A2, 0x0E2, 0x0E1, 0x0CD, 0x0D6, 0x0D3, 0x9F, 0x9F, 0x0CD, 0x0DA, 0x9E, 0x0E2, 0x0CD, 0x9E, 0x0D4, 0x0CD, 0x0E5, 0x9E, 0x0E0, 0x0D9, 0x0CD, 0x0E5, 0x0A2, 0x0E1, 0x0CD, 0x0D7, 0x0E2, 0x0AD, 0x0EB, 0x0D7, 0x0C9, 0x0DE, 0x0B7, 0x0CB, 0x97, 0x0D7, 0x0D6, 0x0C2, 0x0CB, 0x0C8, 0x94, 0x94, 0x0C2, 0x0CF, 0x93, 0x0D7, 0x0C2, 0x93, 0x0C9, 0x0C2, 0x0DA, 0x93, 0x0D5, 0x0CE, 0x0C2, 0x0DA, 0x97, 0x0D6, 0x0C2, 0x0CC, 0x0D7, 0x0A2, 0x0E0, 0x0DA, 0x0EF, 0x0C8, 0x0DC, 0x0A8, 0x0E8, 0x0E7, 0x0D3, 0x0DC, 0x0D9, 0x0A5, 0x0A5, 0x0D3, 0x0E0, 0x0A4, 0x0E8, 0x0D3, 0x0A4, 0x0DA, 0x0D3, 0x0EB, 0x0A4, 0x0E6, 0x0DF, 0x0D3, 0x0EB, 0x0A8, 0x0E7, 0x0D3, 0x0DD, 0x0E8, 0x0B3, 0x0F1, 0x0E1, 0x0BA, 0x0CE, 0x9A, 0x0DA, 0x0D9, 0x0C5, 0x0CE, 0x0CB, 0x97, 0x97, 0x0C5, 0x0D2, 0x96, 0x0DA, 0x0C5, 0x96, 0x0CC, 0x0C5, 0x0DD, 0x96, 0x0D8, 0x0D1, 0x0C5, 0x0DD, 0x9A, 0x0D9, 0x0C5, 0x0CF, 0x0DA, 0x0A5, 0x0E3, 0x0CF, 0x0E3, 0x0AF, 0x0EF, 0x0EE, 0x0DA, 0x0E3, 0x0E0, 0x0AC, 0x0AC, 0x0DA, 0x0E7, 0x0AB, 0x0EF, 0x0DA, 0x0AB, 0x0E1, 0x0DA, 0x0F2, 0x0AB, 0x0ED, 0x0E6, 0x0DA, 0x0F2, 0x0AF, 0x0EE, 0x0DA, 0x0E4, 0x0EF, 0x0BA, 0x0F8, 0x0BC, 0x88, 0x0C8, 0x0C7, 0x0B3, 0x0BC, 0x0B9, 0x85, 0x85, 0x0B3, 0x0C0, 0x84, 0x0C8, 0x0B3, 0x84, 0x0BA, 0x0B3, 0x0CB, 0x84, 0x0C6, 0x0BF, 0x0B3, 0x0CB, 0x88, 0x0C7, 0x0B3, 0x0BD, 0x0C8, 0x93, 0x0D1, 0x9C, 0x0DC, 0x0DB, 0x0C7, 0x0D0, 0x0CD, 0x99, 0x99, 0x0C7, 0x0D4, 0x98, 0x0DC, 0x0C7, 0x98, 0x0CE, 0x0C7, 0x0DF, 0x98, 0x0DA, 0x0D3, 0x0C7, 0x0DF, 0x9C, 0x0DB, 0x0C7, 0x0D1, 0x0DC, 0x0A7, 0x0E5, 0x0A8, 0x0A7, 0x93, 0x9C, 0x99, 0x65, 0x65, 0x93, 0x0A0, 0x64, 0x0A8, 0x93, 0x64, 0x9A, 0x93, 0x0AB, 0x64, 0x0A6, 0x9F, 0x93, 0x0AB, 0x68, 0x0A7, 0x93, 0x9D, 0x0A8, 0x73, 0x0B1, 0x0E7, 0x0D3, 0x0DC, 0x0D9, 0x0A5, 0x0A5, 0x0D3, 0x0E0, 0x0A4, 0x0E8, 0x0D3, 0x0A4, 0x0DA, 0x0D3, 0x0EB, 0x0A4, 0x0E6, 0x0DF, 0x0D3, 0x0EB, 0x0A8, 0x0E7, 0x0D3, 0x0DD, 0x0E8, 0x0B3, 0x0F1, 0x0D2, 0x0DB, 0x0D8, 0x0A4, 0x0A4, 0x0D2, 0x0DF, 0x0A3, 0x0E7, 0x0D2, 0x0A3, 0x0D9, 0x0D2, 0x0EA, 0x0A3, 0x0E5, 0x0DE, 0x0D2, 0x0EA, 0x0A7, 0x0E6, 0x0D2, 0x0DC, 0x0E7, 0x0B2, 0x0F0, 0x0C7, 0x0C4, 0x90, 0x90, 0x0BE, 0x0CB, 0x8F, 0x0D3, 0x0BE, 0x8F, 0x0C5, 0x0BE, 0x0D6, 0x8F, 0x0D1, 0x0CA, 0x0BE, 0x0D6, 0x93, 0x0D2, 0x0BE, 0x0C8, 0x0D3, 0x9E, 0x0DC, 0x0CD, 0x99, 0x99, 0x0C7, 0x0D4, 0x98, 0x0DC, 0x0C7, 0x98, 0x0CE, 0x0C7, 0x0DF, 0x98, 0x0DA, 0x0D3, 0x0C7, 0x0DF, 0x9C, 0x0DB, 0x0C7, 0x0D1, 0x0DC, 0x0A7, 0x0E5, 0x96, 0x96, 0x0C4, 0x0D1, 0x95, 0x0D9, 0x0C4, 0x95, 0x0CB, 0x0C4, 0x0DC, 0x95, 0x0D7, 0x0D0, 0x0C4, 0x0DC, 0x99, 0x0D8, 0x0C4, 0x0CE, 0x0D9, 0x0A4, 0x0E2, 0x62, 0x90, 0x9D, 0x61, 0x0A5, 0x90, 0x61, 0x97, 0x90, 0x0A8, 0x61, 0x0A3, 0x9C, 0x90, 0x0A8, 0x65, 0x0A4, 0x90, 0x9A, 0x0A5, 0x70, 0x0AE, 0x90, 0x9D, 0x61, 0x0A5, 0x90, 0x61, 0x97, 0x90, 0x0A8, 0x61, 0x0A3, 0x9C, 0x90, 0x0A8, 0x65, 0x0A4, 0x90, 0x9A, 0x0A5, 0x70, 0x0AE, 0x0CB, 0x8F, 0x0D3, 0x0BE, 0x8F, 0x0C5, 0x0BE, 0x0D6, 0x8F, 0x0D1, 0x0CA, 0x0BE, 0x0D6, 0x93, 0x0D2, 0x0BE, 0x0C8, 0x0D3, 0x9E, 0x0DC, 0x9C, 0x0E0, 0x0CB, 0x9C, 0x0D2, 0x0CB, 0x0E3, 0x9C, 0x0DE, 0x0D7, 0x0CB, 0x0E3, 0x0A0, 0x0DF, 0x0CB, 0x0D5, 0x0E0, 0x0AB, 0x0E9, 0x0A4, 0x8F, 0x60, 0x96, 0x8F, 0x0A7, 0x60, 0x0A2, 0x9B, 0x8F, 0x0A7, 0x64, 0x0A3, 0x8F, 0x99, 0x0A4, 0x6F, 0x0AD, 0x0D3, 0x0A4, 0x0DA, 0x0D3, 0x0EB, 0x0A4, 0x0E6, 0x0DF, 0x0D3, 0x0EB, 0x0A8, 0x0E7, 0x0D3, 0x0DD, 0x0E8, 0x0B3, 0x0F1, 0x8F, 0x0C5, 0x0BE, 0x0D6, 0x8F, 0x0D1, 0x0CA, 0x0BE, 0x0D6, 0x93, 0x0D2, 0x0BE, 0x0C8, 0x0D3, 0x9E, 0x0DC, 0x96, 0x8F, 0x0A7, 0x60, 0x0A2, 0x9B, 0x8F, 0x0A7, 0x64, 0x0A3, 0x8F, 0x99, 0x0A4, 0x6F, 0x0AD, 0x0C5, 0x0DD, 0x96, 0x0D8, 0x0D1, 0x0C5, 0x0DD, 0x9A, 0x0D9, 0x0C5, 0x0CF, 0x0DA, 0x0A5, 0x0E3, 0x0D6, 0x8F, 0x0D1, 0x0CA, 0x0BE, 0x0D6, 0x93, 0x0D2, 0x0BE, 0x0C8, 0x0D3, 0x9E, 0x0DC, 0x0A7, 0x0E9, 0x0E2, 0x0D6, 0x0EE, 0x0AB, 0x0EA, 0x0D6, 0x0E0, 0x0EB, 0x0B6, 0x0F4, 0x0A2, 0x9B, 0x8F, 0x0A7, 0x64, 0x0A3, 0x8F, 0x99, 0x0A4, 0x6F, 0x0AD, 0x0DD, 0x0D1, 0x0E9, 0x0A6, 0x0E5, 0x0D1, 0x0DB, 0x0E6, 0x0B1, 0x0EF, 0x0CA, 0x0E2, 0x9F, 0x0DE, 0x0CA, 0x0D4, 0x0DF, 0x0AA, 0x0E8, 0x0D6, 0x93, 0x0D2, 0x0BE, 0x0C8, 0x0D3, 0x9E, 0x0DC, 0x0AB, 0x0EA, 0x0D6, 0x0E0, 0x0EB, 0x0B6, 0x0F4, 0x0A7, 0x93, 0x9D, 0x0A8, 0x73, 0x0B1, 0x0D2, 0x0DC, 0x0E7, 0x0B2, 0x0F0, 0x0C8, 0x0D3, 0x9E, 0x0DC, 0x0DD, 0x0A8, 0x0E6, 0x0B3, 0x0F1, 0x0BC]
counter = 0
for i in range(LEN):
	for j in range(i+1,LEN):
		s.add(a1[i]+a1[j]==a[counter])
		counter+=1 

# ========================================

if s.check() == sat:
	model = s.model()
	print (''.join([chr(model[x].as_long()) for x in a1]))

# ========================================

</code></pre>

<h3 id="flag">flag</h3>

<p><code>inctf{Th4ts_he11_l0t_0f_w0rk_w4s_it?}</code></p>

          </div>
        </div>
      </div>
    </div>
  </section>







<footer class="bg-dark footer-section">
  <div class="section">
    <div class="container">
      <div class="row">
        <div class="col-md-4">
          <h5 class="text-light">Email</h5>
          <p class="text-white paragraph-lg font-secondary">vidnerian@mail.ru</p>
        </div>
        <div class="col-md-4">
          <h5 class="text-light">Phone</h5>
          <p class="text-white paragraph-lg font-secondary">&#43;62</p>
        </div>
        <div class="col-md-4">
          <h5 class="text-light">Address</h5>
          <p class="text-white paragraph-lg font-secondary">Bogor, Indonesia</p>
        </div>
      </div>
    </div>
  </div>
  <div class="border-top text-center border-dark py-5">
    <p class="mb-0 text-light">Powered by <a href="https://themefisher.com/best-hugo-themes">Hugo Themes</a></p>
  </div>
</footer>


<!-- Google Map API -->
<script src="https://vidner.github.io"></script>
<!-- JS Plugins -->

<script src="https://vidner.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://vidner.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://vidner.github.io/plugins/slick/slick.min.js"></script>

<script src="https://vidner.github.io/plugins/shuffle/shuffle.min.js"></script>

<!-- Main Script -->

<script src="https://vidner.github.io/js/script.min.js"></script>
<!-- google analitycs -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'Your ID', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>