<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>vidner</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is meta description">
  <meta name="author" content="Themefisher">
  <meta name="generator" content="Hugo 0.58.3" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://vidner.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://vidner.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://vidner.github.io/plugins/themify-icons/themify-icons.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://vidner.github.io/css/style.min.css" integrity="" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://vidner.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://vidner.github.io/images/favicon.png " type="image/x-icon">

</head><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
   <script>hljs.initHighlightingOnLoad();</script>
   <link rel="stylesheet" href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/xt256.min.css>
   <body>
<!-- preloader start -->
<div class="preloader">
</div>
<!-- preloader end -->
<header class="navigation fixed-top">
  <nav class="navbar navbar-expand-lg navbar-dark">
    <a class="navbar-brand" href="https://vidner.github.io"><h3 class="text-white font-tertiary">vidner</h3></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation"
      aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navigation">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item active">
          <a class="nav-link" href="https://vidner.github.io"> Home </a>
        </li>
        
        
        <li class="nav-item">
          <a class="nav-link" href="https://vidner.github.io/about">About</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link" href="https://vidner.github.io/blog">Blog</a>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link" href="https://vidner.github.io/contact">Contact</a>
        </li>
        
        
      </ul>
    </div>
  </nav>
</header>

  
<section class="page-title bg-primary position-relative overflow-hidden">
  <div class="container">
    <div class="row">
      <div class="col-12 text-center">
        <h1 class="text-white font-tertiary">[ nactf - 2019 - crypto ]  super_duper_AES</h1>
      </div>
    </div>
  </div>
  
  <img src="/images/illustrations/page-title.svg" alt="illustrations" class="bg-shape-1 w-100">
  <img src="/images/illustrations/leaf-pink-round.svg" alt="illustrations" class="bg-shape-2">
  <img src="/images/illustrations/dots-cyan.svg" alt="illustrations" class="bg-shape-3">
  <img src="/images/illustrations/leaf-orange.svg" alt="illustrations" class="bg-shape-4">
  <img src="/images/illustrations/leaf-yellow.svg" alt="illustrations" class="bg-shape-5">
  <img src="/images/illustrations/dots-group-cyan.svg" alt="illustrations" class="bg-shape-6">
  <img src="/images/illustrations/leaf-cyan-lg.svg" alt="illustrations" class="bg-shape-7">
</section>



  <section class="section">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h3 class="font-tertiary mb-5">[ nactf - 2019 - crypto ]  super_duper_AES</h3>
          <p class="font-secondary">Published on Sep 26, 2019 by <span class="text-primary">vidner</span></p>
          <div class="content">
            <img src="https://www.nactf.com/files/6183507d6fd7e02c2cc69792dbbeab31/NA.png" alt="post-thumb" class="img-fluid rounded float-left mr-5 mb-4">
            

<h3 id="super-duper-aes">super duper AES</h3>

<p>The Advanced Encryption Standard (AES) has got to go. Spencer just invented the Super Duper Advanced Encryption Standard (SDAES), and it&rsquo;s 100% unbreakable. AES only performs up to 14 rounds of substitution and permutation, while SDAES performs 10,000. That&rsquo;s so secure, SDAES doesn&rsquo;t even use a key!</p>

<h3 id="attachment">attachment</h3>

<p>cipher.txt: <br>ASCII text, with no line terminators</p>

<p>sdaes.py: <br>Python script, ASCII text executable, with CRLF line terminators</p>

<h3 id="analysis">analysis</h3>

<p>sdaes.py</p>

<pre><code class="language-python">import sys
from binascii import hexlify

def substitute(hexBlock):
    substitutedHexBlock = &quot;&quot;
    substitution =  [8, 4, 15, 9, 3, 14, 6, 2,
                    13, 1, 7, 5, 12, 10, 11, 0]
    for hexDigit in hexBlock:
        newDigit = substitution[int(hexDigit, 16)]
        substitutedHexBlock += hex(newDigit)[2:]
    return substitutedHexBlock

def pad(message):
    numBytes = 4-(len(message)%4)
    return message + numBytes * chr(numBytes)

def hexpad(hexBlock):
    numZeros = 8 - len(hexBlock)
    return numZeros*&quot;0&quot; + hexBlock

def permute(hexBlock):
    permutation =   [6, 22, 30, 18, 29, 4, 23, 19,
                    15, 1, 31, 11, 28, 14, 25, 2,
                    27, 12, 21, 26, 10, 16, 0, 24,
                     7, 5, 3, 20, 13, 9, 17, 8]
    block = int(hexBlock, 16)
    permutedBlock = 0
    for i in range(32):
        bit = (block &amp; (1 &lt;&lt; i)) &gt;&gt; i
        permutedBlock |= bit &lt;&lt; permutation[i]
    return hexpad(hex(permutedBlock)[2:])

def round(hexMessage):
    numBlocks = len(hexMessage)//8
    substitutedHexMessage = &quot;&quot;
    for i in range(numBlocks):
        substitutedHexMessage += substitute(hexMessage[8*i:8*i+8])
    permutedHexMessage = &quot;&quot;
    for i in range(numBlocks):
        permutedHexMessage += permute(substitutedHexMessage[8*i:8*i+8])
    return permutedHexMessage



if __name__ == &quot;__main__&quot;:
    hexMessage = str(hexlify(str.encode(pad(sys.argv[1]))))
    if &quot;\'&quot; in hexMessage:
        hexMessage = hexMessage[2:-1]

    for i in range(10000):
        hexMessage = round(hexMessage)
    print (hexMessage)
</code></pre>

<p>cipher.txt</p>

<pre><code class="language-sh">ian@vidner ~/Downloads&gt; cat cipher.txt
d59fd3f37182486a44231de4713131d20324fbfe80e91ae48658ba707cb84841972305fc3e0111c753733cf2‚èé
</code></pre>

<p>sdaes.py is python implemented <code>AES</code> but without a <code>key</code> , wtf ? ? ?  , doesnt matter how many rounds this cipher does , we can get the plaintext easily by doing it the opposite way .</p>

<p>round function but the opposite way</p>

<pre><code class="language-python">def round(hexMessage):
    numBlocks = len(hexMessage)//8
    permutedHexMessage = &quot;&quot;
    for i in range(numBlocks):
        permutedHexMessage += permute(hexMessage[8*i:8*i+8]) #opposite-way
    subtitutedHexMessage = &quot;&quot;
    for i in range(numBlocks):
        subtitutedHexMessage += substitute(permutedHexMessage[8*i:8*i+8]) #opposite-way
    return subtitutedHexMessage
</code></pre>

<p><code>permuted</code> function but the opposite way</p>

<pre><code class="language-python">def permute(hexBlock):
    permutation = [8, 4, 15, 9, 3, 14, 6, 2,
                    13, 1, 7, 5, 12, 10, 11, 0]
    block = int(hexBlock, 16)
    permutedBlock = 0
    counter = 0
    for i in permutation:
        bit = (block &amp; (1 &lt;&lt; i)) &gt;&gt; i
        permutedBlock |= bit &lt;&lt; counter #opposite-way
        counter+=1
    return hexpad(hex(permutedBlock)[2:])
</code></pre>

<p><code>substitute</code> function but the opposite way</p>

<pre><code class="language-python">def substitute(hexBlock):
    substitutedHexBlock = &quot;&quot;
    substitution = [6, 22, 30, 18, 29, 4, 23, 19,
                    15, 1, 31, 11, 28, 14, 25, 2,
                    27, 12, 21, 26, 10, 16, 0, 24,
                     7, 5, 3, 20, 13, 9, 17, 8]
    for hexDigit in hexBlock:
        newDigit = substitution.index(int(hexDigit, 16)) #opposite-way
        substitutedHexBlock += hex(newDigit)[2:]
    return substitutedHexBlock
</code></pre>

<p>now just loop it 10000 times then we should get the flag</p>

<pre><code class="language-python">if __name__ == &quot;__main__&quot;:
    hexMessage = &quot;d59fd3f37182486a44231de4713131d20324fbfe80e91ae48658ba707cb84841972305fc3e0111c753733cf2&quot;
    # a = hexMessage
    for i in range(10000):
        hexMessage = round(hexMessage)
    print (unhexlify(hexMessage))
</code></pre>

<h3 id="flag">flag</h3>

<p><code>nactf{5ub5t1tut10n_p3rmutat10n_n33d5_a_k3y}</code></p>

          </div>
        </div>
      </div>
    </div>
  </section>







<footer class="bg-dark footer-section">
  <div class="section">
    <div class="container">
      <div class="row">
        <div class="col-md-4">
          <h5 class="text-light">Email</h5>
          <p class="text-white paragraph-lg font-secondary">vidnerian@mail.ru</p>
        </div>
        <div class="col-md-4">
          <h5 class="text-light">Phone</h5>
          <p class="text-white paragraph-lg font-secondary">&#43;62</p>
        </div>
        <div class="col-md-4">
          <h5 class="text-light">Address</h5>
          <p class="text-white paragraph-lg font-secondary">Bogor, Indonesia</p>
        </div>
      </div>
    </div>
  </div>
  <div class="border-top text-center border-dark py-5">
    <p class="mb-0 text-light">Powered by <a href="https://themefisher.com/best-hugo-themes">Hugo Themes</a></p>
  </div>
</footer>


<!-- Google Map API -->
<script src="https://vidner.github.io"></script>
<!-- JS Plugins -->

<script src="https://vidner.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://vidner.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://vidner.github.io/plugins/slick/slick.min.js"></script>

<script src="https://vidner.github.io/plugins/shuffle/shuffle.min.js"></script>

<!-- Main Script -->

<script src="https://vidner.github.io/js/script.min.js"></script>
<!-- google analitycs -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'Your ID', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>